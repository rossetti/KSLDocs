<!DOCTYPE html>
<html class="no-js">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1" charset="UTF-8">
    <title>waitedForBatch</title>
    <link href="../../../images/logo-icon.svg" rel="icon" type="image/svg">
    <script>var pathToRoot = "../../../";</script>
    <script>document.documentElement.classList.replace("no-js","js");</script>
    <script>const storage = localStorage.getItem("dokka-dark-mode")
    if (storage == null) {
        const osDarkSchemePreferred = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
        if (osDarkSchemePreferred === true) {
            document.getElementsByTagName("html")[0].classList.add("theme-dark")
        }
    } else {
        const savedDarkMode = JSON.parse(storage)
        if(savedDarkMode === true) {
            document.getElementsByTagName("html")[0].classList.add("theme-dark")
        }
    }
    </script>
<script type="text/javascript" src="https://unpkg.com/kotlin-playground@1/dist/playground.min.js" async="async"></script>
<script type="text/javascript" src="../../../scripts/sourceset_dependencies.js" async="async"></script>
<link href="../../../styles/style.css" rel="Stylesheet">
<link href="../../../styles/main.css" rel="Stylesheet">
<link href="../../../styles/prism.css" rel="Stylesheet">
<link href="../../../styles/logo-styles.css" rel="Stylesheet">
<link href="../../../styles/font-jb-sans-auto.css" rel="Stylesheet">
<link href="../../../ui-kit/ui-kit.min.css" rel="Stylesheet">
<script type="text/javascript" src="../../../scripts/clipboard.js" async="async"></script>
<script type="text/javascript" src="../../../scripts/navigation-loader.js" async="async"></script>
<script type="text/javascript" src="../../../scripts/platform-content-handler.js" async="async"></script>
<script type="text/javascript" src="../../../scripts/main.js" defer="defer"></script>
<script type="text/javascript" src="../../../scripts/prism.js" async="async"></script>
<script type="text/javascript" src="../../../ui-kit/ui-kit.min.js" defer="defer"></script>
<script type="text/javascript" src="../../../scripts/symbol-parameters-wrapper_deferred.js" defer="defer"></script>
</head>
<body>
    <div class="root">
    <nav class="navigation theme-dark" id="navigation-wrapper">
            <a class="library-name--link" href="../../../index.html">
                    KSLCore
            </a>
        <button class="navigation-controls--btn navigation-controls--btn_toc ui-kit_mobile-only" id="toc-toggle"
                type="button">Toggle table of contents
        </button>
        <div class="navigation-controls--break ui-kit_mobile-only"></div>
        <div class="library-version" id="library-version">
R1.1.9        </div>
        <div class="navigation-controls">
        <div class="filter-section filter-section_loading" id="filter-section">
                <button class="platform-tag platform-selector jvm-like" data-active=""
                        data-filter=":dokkaHtml/main">jvm</button>
            <div class="dropdown filter-section--dropdown" data-role="dropdown" id="filter-section-dropdown">
                <button class="button button_dropdown filter-section--dropdown-toggle" role="combobox"
                        data-role="dropdown-toggle"
                        aria-controls="platform-tags-listbox"
                        aria-haspopup="listbox"
                        aria-expanded="false"
                        aria-label="Toggle source sets"
                ></button>
                <ul role="listbox" id="platform-tags-listbox" class="dropdown--list" data-role="dropdown-listbox">
                    <div class="dropdown--header"><span>Platform filter</span>
                        <button class="button" data-role="dropdown-toggle" aria-label="Close platform filter">
                            <i class="ui-kit-icon ui-kit-icon_cross"></i>
                        </button>
                    </div>
                        <li role="option" class="dropdown--option platform-selector-option jvm-like" tabindex="0">
                            <label class="checkbox">
                                <input type="checkbox" class="checkbox--input" id=":dokkaHtml/main"
                                       data-filter=":dokkaHtml/main"/>
                                <span class="checkbox--icon"></span>
                                jvm
                            </label>
                        </li>
                </ul>
                <div class="dropdown--overlay"></div>
            </div>
        </div>
            <button class="navigation-controls--btn navigation-controls--btn_theme" id="theme-toggle-button"
                    type="button">Switch theme
            </button>
            <div class="navigation-controls--btn navigation-controls--btn_search" id="searchBar" role="button">Search in
                API
            </div>
        </div>
    </nav>
        <div id="container">
            <div class="sidebar" id="leftColumn">
                <div class="dropdown theme-dark_mobile" data-role="dropdown" id="toc-dropdown">
                    <ul role="listbox" id="toc-listbox" class="dropdown--list dropdown--list_toc-list"
                        data-role="dropdown-listbox">
                        <div class="dropdown--header">
                            <span>
                                    KSLCore
                            </span>
                            <button class="button" data-role="dropdown-toggle" aria-label="Close table of contents">
                                <i class="ui-kit-icon ui-kit-icon_cross"></i>
                            </button>
                        </div>
                        <div class="sidebar--inner" id="sideMenu"></div>
                    </ul>
                    <div class="dropdown--overlay"></div>
                </div>
            </div>
            <div id="main">
<div class="main-content" data-page-type="member" id="content" pageIds="KSLCore::ksl.modeling.entity/KSLProcessBuilder/waitedForBatch/#TypeParam(bounds=[ksl.modeling.entity.ProcessModel.BatchingEntity[^]])#ksl.modeling.entity.BatchQueue[TypeParam(bounds=[ksl.modeling.entity.ProcessModel.BatchingEntity[^]])]#kotlin.String#kotlin.Int#kotlin.Function1[TypeParam(bounds=[ksl.modeling.entity.ProcessModel.BatchingEntity[^]]),kotlin.Boolean]#kotlin.String?/PointingToDeclaration//769193423">
  <div class="breadcrumbs"><a href="../../../index.html">KSLCore</a><span class="delimiter">/</span><a href="../index.html">ksl.modeling.entity</a><span class="delimiter">/</span><a href="index.html">KSLProcessBuilder</a><span class="delimiter">/</span><span class="current">waitedForBatch</span></div>
  <div class="cover ">
    <h1 class="cover"><span>waited</span><wbr></wbr><span>For</span><wbr></wbr><span><span>Batch</span></span></h1>
  </div>
  <div class="platform-hinted " data-platform-hinted="data-platform-hinted"><div class="content sourceset-dependent-content" data-active="" data-togglable=":dokkaHtml/main"><div class="symbol monospace"><span class="token keyword">abstract </span><span class="token keyword">suspend </span><span class="token keyword">fun </span><span class="token operator">&lt;</span><a href="waited-for-batch.html">T</a><span class="token operator"> : </span><a href="../-process-model/-batching-entity/index.html">ProcessModel.BatchingEntity</a><span class="token operator">&lt;</span><a href="waited-for-batch.html">T</a><span class="token operator">&gt;</span><span class="token operator">&gt; </span><a href="waited-for-batch.html"><span class="token function">waitedForBatch</span></a><span class="token punctuation">(</span><span class="parameters "><span class="parameter ">candidateForBatch<span class="token operator">: </span><a href="waited-for-batch.html">T</a><span class="token punctuation">, </span></span><span class="parameter ">batchingQ<span class="token operator">: </span><a href="../-batch-queue/index.html">BatchQueue</a><span class="token operator">&lt;</span><a href="waited-for-batch.html">T</a><span class="token operator">&gt;</span><span class="token punctuation">, </span></span><span class="parameter ">batchName<span class="token operator">: </span><a href="https://kotlinlang.org/api/core/kotlin-stdlib/kotlin/-string/index.html">String</a><span class="token operator"> = </span>batchingQ.name<span class="token punctuation">, </span></span><span class="parameter ">batchSize<span class="token operator">: </span><a href="https://kotlinlang.org/api/core/kotlin-stdlib/kotlin/-int/index.html">Int</a><span class="token operator"> = </span>batchingQ.batchSize<span class="token punctuation">, </span></span><span class="parameter ">predicate<span class="token operator">: </span><span class="token punctuation">(</span><a href="waited-for-batch.html">T</a><span class="token punctuation">)</span><span class="token operator"> -&gt; </span><a href="https://kotlinlang.org/api/core/kotlin-stdlib/kotlin/-boolean/index.html">Boolean</a><span class="token operator"> = </span>batchingQ.batchingPredicate<span class="token punctuation">, </span></span><span class="parameter ">suspensionName<span class="token operator">: </span><a href="https://kotlinlang.org/api/core/kotlin-stdlib/kotlin/-string/index.html">String</a><span class="token operator">?</span><span class="token operator"> = </span>null</span></span><span class="token punctuation">)</span><span class="token operator">: </span><a href="https://kotlinlang.org/api/core/kotlin-stdlib/kotlin/-boolean/index.html">Boolean</a></div><p class="paragraph">The purpose of this suspending function is to allow a batching entity to wait for a batch to be formed.  If a batch can be formed using the candidate entity, then the batch is formed and the function returns false. If the batch cannot be formed, the candidate entity waits in the batch queue and suspends. If the batch can be formed, the batch is attached to the batching entity using the supplied batch name. The batching entity will hold the batched entities in a list associated with the supplied batch name via a map. The entities entering the batch queue wait until the number of entities satisfying the supplied predicate is equal to the supplied batch size. The returned Boolean value associated with the function indicates if the entity is part of the batch and if so, it must exit from the process. The entity that caused the batch to form, will cause the function to return false, when it returns from its suspension.  All entities that enter this suspending function will suspend. The resumption of the suspension is predicated on the formation of the batch.</p><p class="paragraph">Notice that the associated BatchingQueue must hold entities that are the same type (subclass) of BatchingEntity. Only entities of the same type can be batched together via this functionality.</p><p class="paragraph"><strong>WARNING</strong> The proper use of this method must have the following form:</p><div class="sample-container"><pre><code class="block lang-kotlin" theme="idea">// within a process()<br><br>if (waitedForBatch(candidate, batchingQ, batchName, batchSize, predicate, suspensionName)) {<br>    return@process<br>}<br>// the continuing entity is the one that caused the batch to be formed</code></pre><span class="top-right-position"><span class="copy-icon"></span><div class="copy-popup-wrapper popup-to-left"><span class="copy-popup-icon"></span><span>Content copied to clipboard</span></div></span></div><p class="paragraph">That is, you <strong>must</strong> wrap the usage of this suspending function within an if-statement construct.</p><p class="paragraph">Note the use of the <a href="https://kotlinlang.org/docs/returns.html#return-to-labels">explicitly labeled return</a> to exit from the process. This is essential. The entities that waited for the batch because the if statement was true, will be resumed when the batch is formed and must be allowed to return from the process and not continue with the current process.</p><span class="kdoc-tag"><h4 class="">Return</h4><p class="paragraph">the returned Boolean indicates whether the suspending entity should exit from its process as a result of the call to the suspending function. The caller must cause the exit from the process for the entities within the batch.</p></span><h4 class="">Parameters</h4><div class="table"><div class="table-row" data-filterable-current=":dokkaHtml/main" data-filterable-set=":dokkaHtml/main"><div class="main-subrow keyValue "><div class=""><span class="inline-flex"><div><u><span>candidate</span><wbr></wbr><span>For</span><wbr></wbr><span><span>Batch</span></span></u></div></span></div><div><div class="title"><p class="paragraph">this must be the current entity, and it must be a batching entity</p></div></div></div></div><div class="table-row" data-filterable-current=":dokkaHtml/main" data-filterable-set=":dokkaHtml/main"><div class="main-subrow keyValue "><div class=""><span class="inline-flex"><div><u><span>batching</span><wbr></wbr><span><span>Q</span></span></u></div></span></div><div><div class="title"><p class="paragraph">the queue from which to form the batch</p></div></div></div></div><div class="table-row" data-filterable-current=":dokkaHtml/main" data-filterable-set=":dokkaHtml/main"><div class="main-subrow keyValue "><div class=""><span class="inline-flex"><div><u><span>batch</span><wbr></wbr><span><span>Name</span></span></u></div></span></div><div><div class="title"><p class="paragraph">the name to associate with the batch. By default, this will be the name of the batch queue.</p></div></div></div></div><div class="table-row" data-filterable-current=":dokkaHtml/main" data-filterable-set=":dokkaHtml/main"><div class="main-subrow keyValue "><div class=""><span class="inline-flex"><div><u><span>batch</span><wbr></wbr><span><span>Size</span></span></u></div></span></div><div><div class="title"><p class="paragraph">the number of elements to form into a batch. The default is specified by the batch queue's batch size property.</p></div></div></div></div><div class="table-row" data-filterable-current=":dokkaHtml/main" data-filterable-set=":dokkaHtml/main"><div class="main-subrow keyValue "><div class=""><span class="inline-flex"><div><u><span><span>predicate</span></span></u></div></span></div><div><div class="title"><p class="paragraph">the predicate governing which entities from the queue are selected for the batch. By default, this is the specified by the batching predicate from the batch queue, which is an always true predicate. Thus, the default is to form a batch of the specified size from whatever is in the queue.</p></div></div></div></div><div class="table-row" data-filterable-current=":dokkaHtml/main" data-filterable-set=":dokkaHtml/main"><div class="main-subrow keyValue "><div class=""><span class="inline-flex"><div><u><span>suspension</span><wbr></wbr><span><span>Name</span></span></u></div></span></div><div><div class="title"><p class="paragraph">the name of the possible suspension point. This can be used by the entity to determine which send blocking it might be experiencing when blocked.  It is up to the client to ensure the name is meaningful and possibly unique.</p></div></div></div></div></div></div></div>
</div>
    <div class="footer">
        <a href="#content" id="go-to-top-link" class="footer--button footer--button_go-to-top"></a>
        <span>© 2025 Copyright</span>
        <span class="pull-right">
            <span>Generated by </span>
            <a class="footer--link footer--link_external" href="https://github.com/Kotlin/dokka">
                <span>dokka</span>
            </a>
        </span>
    </div>
            </div>
        </div>
    </div>
</body>
</html>